function f(a,t,e,s,n,i,c,p){var r=typeof a=="function"?a.options:a;t&&(r.render=t,r.staticRenderFns=e,r._compiled=!0),s&&(r.functional=!0),i&&(r._scopeId="data-v-"+i);var o;if(c?(o=function(l){l=l||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!l&&typeof __VUE_SSR_CONTEXT__<"u"&&(l=__VUE_SSR_CONTEXT__),n&&n.call(this,l),l&&l._registeredComponents&&l._registeredComponents.add(c)},r._ssrRegister=o):n&&(o=p?function(){n.call(this,(r.functional?this.parent:this).$root.$options.shadowRoot)}:n),o)if(r.functional){r._injectStyles=o;var h=r.render;r.render=function(m,u){return o.call(u),h(m,u)}}else{var d=r.beforeCreate;r.beforeCreate=d?[].concat(d,o):[o]}return{exports:a,options:r}}const g={props:{title:String,instructions:String,action:String,blueprint:Array,meta:Array,redirectTo:String,values:Array,data:Array,items:Array,type:String},computed:{lastPage(){return Math.ceil(this.totalItems/this.perPage)}},data(){return{itemsReady:[],itemsSliced:[],perPage:10,currentPage:1,totalItems:0,selectedFile:null,search:"",fileName:"Choose a file...",selectedPage:""}},watch:{search:{immediate:!0,handler(){this.sliceItems()}}},mounted(){this.itemsReady=this.items,this.totalItems=this.items.length,this.sliceItems()},methods:{updateItems(a){this.itemsReady=a.data.data,this.totalItems=a.data.data.length,this.sliceItems(),this.$forceUpdate()},setPage(a){this.currentPage=a,this.sliceItems()},sliceItems(){let a=this.itemsReady;this.search&&(a=a.filter(s=>Object.values(s).map(i=>i.toString().toLowerCase()).some(i=>i.includes(this.search.toLowerCase()))));const t=(this.currentPage-1)*this.perPage,e=t+this.perPage;this.totalItems=a.length,this.itemsSliced=a.slice(t,e)},deleteRedirect(a,t){confirm("Are you sure you want to delete this redirect?")&&Statamic.$axios.post(cp_url("alt-design/alt-redirect/delete"),{from:a,id:t}).then(e=>{this.updateItems(e)}).catch(e=>{console.log(e)})},deleteQueryString(a){confirm("Are you sure you want to delete this query string?")&&Statamic.$axios.post(cp_url("/alt-design/alt-redirect/query-strings/delete"),{query_string:a}).then(t=>{this.updateItems(t)}).catch(t=>{console.log(t)})},importFromCSV(){if(!this.selectedFile){alert("You haven't attached a CSV file!");return}var a=new FormData;a.append("file",this.selectedFile),a.append("data",JSON.stringify(this.itemsReady)),Statamic.$axios.post(cp_url("alt-design/alt-redirect/import"),a,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{location.reload()}).catch(t=>{console.log(t)})},handleFileUpload(a){this.selectedFile=a.target.files[0],this.fileName=this.selectedFile?this.selectedFile.name:"Choose a file..."},dropdownPageChange(){this.setPage(this.selectedPage)},toggleKey(a,t){Statamic.$axios.post(cp_url("/alt-design/alt-redirect/query-strings/toggle"),{index:a,toggleKey:t}).then(e=>{this.updateItems(e)}).catch(e=>{console.log(e)})}}};var _=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"alt-redirect"}},[e("h1",{staticClass:"flex-1"},[t._v(t._s(t.title))]),e("h2",{staticClass:"flex-1"},[t._v(t._s(t.instructions))]),e("publish-form",{attrs:{title:"",action:t.action,blueprint:t.blueprint,meta:t.meta,values:t.values},on:{saved:function(s){return t.updateItems(s)}}}),e("div",{staticClass:"card overflow-hidden p-0"},[e("div",{staticClass:"mt-4 pb-2 px-4"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"input-text",attrs:{type:"text",placeholder:"Search"},domProps:{value:t.search},on:{input:function(s){s.target.composing||(t.search=s.target.value)}}})]),e("div",{staticClass:"px-2"},[t.type=="redirects"?e("table",{staticClass:"data-table",staticStyle:{"table-layout":"fixed"},attrs:{"data-size":"sm",tabindex:"0"}},[t._m(0),e("tbody",t._l(t.itemsSliced,function(s){return e("tr",{key:s.id,staticStyle:{width:"100%",overflow:"clip"}},[e("td",[t._v(" "+t._s(s.from)+" ")]),e("td",[t._v(" "+t._s(s.to)+" ")]),e("td",[t._v(" "+t._s(s.redirect_type)+" ")]),e("td",[t._v(" "+t._s(s.sites&&s.sites.length?s.sites.join(", "):"Unknown")+" ")]),e("td",[e("button",{staticClass:"btn",staticStyle:{color:"#bc2626"},on:{click:function(n){return t.deleteRedirect(s.from,s.id)}}},[t._v("Remove ")])])])}),0)]):t._e(),t.type=="query-strings"?e("table",{staticClass:"data-table",staticStyle:{"table-layout":"fixed"},attrs:{"data-size":"sm",tabindex:"0"}},[t._m(1),e("tbody",t._l(t.itemsSliced,function(s,n){return e("tr",{key:s.id,staticStyle:{width:"100%",overflow:"clip"}},[e("td",[t._v(" "+t._s(s.query_string)+" ")]),e("td",[e("button",{staticClass:"toggle-container",class:{on:s.strip},attrs:{type:"button","aria-pressed":"false","aria-label":"Toggle Button",id:"field_preserve"},on:{click:function(i){return t.toggleKey(s.query_string,"strip")}}},[t._m(2,!0)])]),e("td",[t._v(" "+t._s(s.sites&&s.sites.length?s.sites.join(", "):"Unknown")+" ")]),e("td",[e("button",{staticClass:"btn",staticStyle:{color:"#bc2626"},on:{click:function(i){return t.deleteQueryString(s.query_string)}}},[t._v("Remove ")])])])}),0)]):t._e()]),e("div",{staticClass:"pagination text-sm py-4 px-4 flex items-center justify-between"},[e("div",{staticClass:"w-1/3 flex items-center"},[t._v(" Page "),e("span",{staticClass:"font-semibold mx-1",domProps:{innerHTML:t._s(t.currentPage)}}),t._v(" of "),e("span",{staticClass:"mx-1",domProps:{innerHTML:t._s(t.lastPage)}})]),e("div",{staticClass:"w-1/3 flex items-center justify-center"},[e("span",{staticClass:"cursor-pointer",staticStyle:{height:"15px",margin:"0 15px",width:"12px"},on:{click:function(s){return t.setPage(t.currentPage-1>0?t.currentPage-1:1)}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"205",height:"205",viewBox:"0 0 205 205"}},[e("defs",[e("clipPath",{attrs:{id:"clip-LEFT"}},[e("rect",{attrs:{width:"205",height:"205"}})])]),e("g",{attrs:{id:"LEFT","clip-path":"url(#clip-LEFT)"}},[e("rect",{attrs:{width:"205",height:"205",fill:"#fff"}}),e("path",{attrs:{stroke:"#2e9fff",fill:"#2e9fff",id:"Icon_awesome-arrow-left","data-name":"Icon awesome-arrow-left",d:"M114.961,184.524l-9.91,9.91a10.669,10.669,0,0,1-15.132,0L3.143,107.7a10.669,10.669,0,0,1,0-15.132L89.919,5.794a10.669,10.669,0,0,1,15.132,0l9.91,9.91a10.725,10.725,0,0,1-.179,15.311L60.994,82.259H189.283A10.687,10.687,0,0,1,200,92.972v14.284a10.687,10.687,0,0,1-10.713,10.713H60.994l53.789,51.244A10.648,10.648,0,0,1,114.961,184.524Z",transform:"translate(2.004 2.353)"}})])])]),t.currentPage>1?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(1)}}},[t._v("1")]):t._e(),t.currentPage==1?e("span",{staticClass:"cursor-pointer py-1 mx-1 font-semibold",on:{click:function(s){return t.setPage(1)}}},[t._v("1")]):t._e(),t.currentPage>3?e("span",[t._v("...")]):t._e(),t.currentPage>2?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(t.currentPage-1)}}},[t._v(t._s(t.currentPage-1))]):t._e(),t.currentPage!==1&&t.currentPage!==t.lastPage?e("span",{staticClass:"cursor-pointer py-1 mx-1 font-semibold"},[t._v(t._s(t.currentPage))]):t._e(),t.currentPage<t.lastPage-1?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(t.currentPage+1)}}},[t._v(t._s(t.currentPage+1))]):t._e(),t.currentPage<t.lastPage-2?e("span",[t._v("...")]):t._e(),t.currentPage<t.lastPage?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(t.lastPage)}}},[t._v(t._s(t.lastPage))]):t._e(),t.currentPage==t.lastPage&&t.lastPage!=1?e("span",{staticClass:"cursor-pointer py-1 mx-1 font-semibold",on:{click:function(s){return t.setPage(t.lastPage)}}},[t._v(t._s(t.lastPage))]):t._e(),e("span",{staticClass:"cursor-pointer",staticStyle:{height:"15px",margin:"0 15px",width:"12px"},on:{click:function(s){return t.setPage(t.currentPage+1<t.lastPage?t.currentPage+1:t.lastPage)}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"205",height:"205",viewBox:"0 0 205 205"}},[e("defs",[e("clipPath",{attrs:{id:"clip-RIGHT"}},[e("rect",{attrs:{width:"205",height:"205"}})])]),e("g",{attrs:{id:"RIGHT","clip-path":"url(#clip-RIGHT)"}},[e("rect",{attrs:{width:"205",height:"205",fill:"#fff"}}),e("path",{attrs:{stroke:"#2e9fff",fill:"#2e9fff",id:"Icon_awesome-arrow-left","data-name":"Icon awesome-arrow-left",d:"M85.032,184.524l9.91,9.91a10.669,10.669,0,0,0,15.132,0L196.85,107.7a10.669,10.669,0,0,0,0-15.132L110.073,5.794a10.669,10.669,0,0,0-15.132,0l-9.91,9.91a10.725,10.725,0,0,0,.179,15.311L139,82.259H10.71A10.687,10.687,0,0,0,0,92.972v14.284A10.687,10.687,0,0,0,10.71,117.969H139L85.21,169.214A10.648,10.648,0,0,0,85.032,184.524Z",transform:"translate(2.004 2.353)"}})])])])]),e("div",{staticClass:"w-1/3 flex justify-end"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedPage,expression:"selectedPage"}],staticClass:"w-1/2 text-sm",on:{change:[function(s){var n=Array.prototype.filter.call(s.target.options,function(i){return i.selected}).map(function(i){var c="_value"in i?i._value:i.value;return c});t.selectedPage=s.target.multiple?n:n[0]},t.dropdownPageChange]}},[e("option",{attrs:{value:"",disabled:""}},[t._v("Select Page")]),t._l(t.lastPage,function(s){return e("option",{key:s,domProps:{value:s}},[t._v(t._s(s))])})],2)])])]),e("div",{staticClass:"flex justify-between",class:{hidden:t.type=="query-strings"}},[e("div",{staticClass:"w-full xl:w-1/2 card overflow-hidden p-0 mb-4 mt-4 mr-4 px-4 py-4"},[e("span",{staticClass:"font-semibold mb-2"},[t._v("CSV Export")]),e("br"),e("p",{staticClass:"text-sm mb-4"},[t._v("Exports CSV of all redirects, use this format on import.")]),e("a",{staticClass:"btn-primary",attrs:{href:t.cp_url("/alt-design/alt-redirect/export"),download:""}},[t._v("Export CSV")])]),e("div",{staticClass:"w-full xl:w-1/2 card overflow-hidden p-0 mb-4 mt-4 ml-4 px-4 py-4"},[e("span",{staticClass:"font-semibold mb-2"},[t._v("CSV Import")]),e("br"),e("p",{staticClass:"text-sm mb-4"},[t._v("Import CSV for redirects, use the export format on import.")]),e("div",{staticClass:"flex justify-between items-center"},[e("div",[e("input",{staticClass:"hidden",attrs:{type:"file",id:"file-upload"},on:{change:t.handleFileUpload}}),e("label",{staticClass:"btn-primary",attrs:{for:"file-upload"}},[t._v("Upload File")]),e("span",{staticClass:"file-upload-cover px-4"},[t._v(t._s(t.fileName))])]),e("button",{staticClass:"btn-primary",on:{click:function(s){return t.importFromCSV()}}},[t._v("Import")])])])])],1)},v=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",{staticClass:"group from-column sortable-column",staticStyle:{width:"33%"}},[t("span",[a._v("From")])]),t("th",{staticClass:"group from-column sortable-column pr-8 w-24",staticStyle:{width:"33%"}},[t("span",[a._v("To")])]),t("th",{staticClass:"group to-column pr-8",staticStyle:{width:"8%"}},[t("span",[a._v("Type")])]),t("th",{staticClass:"group to-column pr-8",staticStyle:{width:"15%"}},[t("span",[a._v("Sites")])]),t("th",{staticClass:"actions-column",staticStyle:{width:"13.4%"}})])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",{staticClass:"group from-column sortable-column",staticStyle:{width:"46%"}},[t("span",[a._v("Query String Key")])]),t("th",{staticClass:"group to-column pr-8",staticStyle:{width:"20%"}},[t("span",[a._v("Strip")])]),t("th",{staticClass:"group to-column pr-8",staticStyle:{width:"20.6%"}},[t("span",[a._v("Sites")])]),t("th",{staticClass:"actions-column",staticStyle:{width:"13.4%"}})])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"toggle-slider"},[t("div",{staticClass:"toggle-knob",attrs:{tabindex:"0"}})])}],y=f(g,_,v,!1,null,"edee952c",null,null);const w=y.exports;Statamic.booting(()=>{Statamic.$components.register("alt-redirect",w)});
